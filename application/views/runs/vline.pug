extends ../layout
    
block head
  - let title = `${trip.departureTime} ${trip.origin.slice(0, -16)} to ${trip.destination.slice(0, -16)}`
  title=`TransportVic - ${title}`
  
  meta(property='og:title' content=`TransportVic - ${title}`)
  meta(property='twitter:title' content=`TransportVic - ${title}`)
  meta(property='og:description' content=`Viewing the ${title}`)
  meta(property='twitter:description' content=`Viewing the ${title}`)
  
block title
  span=title
  
block style
  link(rel='stylesheet' href='/static/css/runs/base-style.css')
  link(rel='stylesheet' href='/static/css/runs/trains.css')

block content
  if trip.runID
    div.infoRow
      span=`Run ${trip.runID}`
      -
        let {vehicle, consist} = trip
        let parts
        if (vehicle) {
          if (vehicle.startsWith('N'))
            parts = [null, 'N']
          else if (vehicle.includes('VL')) {
            let count = (vehicle.match(/^(\d)x/) || [0, 1])[1]
            parts = [count, 'vlocity']
          } else {
            parts = vehicle.match(/(\d)x ([A-Za-z]+)/).slice(1, 3)
            if (parts[1] === 'SP') parts[1] = 'sprinter'
          }
        }
      if vehicle
        div.vehicle
          if parts[0]
            span=parts[0] + 'x'
          else
            span
          img(src=`/static/images/icons/${parts[1].toLowerCase()}.svg`)
    if consist
      div.liveConsist
        span.header Live Tracking
        span.consist=consist.join('-')
  div.timing-list
    for stop in trip.stopTimings
      div.timingRow(id='stop-' + stop.stopGTFSID)
        a.departureInfo
          span.stopName=stop.stopName
          if stop.cancelled || trip.cancelled
            span.info.cancelled CANCELLED
        div(class=`timing${stop.cancelled || trip.cancelled ? ' cancelled' : ' unknown'}`)
          span=stop.prettyTimeToArrival
          span=stop.departureTime || stop.arrivalTime
